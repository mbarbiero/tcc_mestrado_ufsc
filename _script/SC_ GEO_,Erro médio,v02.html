<!DOCTYPE html>
<html lang="pt-br">

<head>
    <meta charset="UTF-8">
    <title>SC_ Quadra - Coordenadas Ajustadas</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        body {
            margin: 0; padding: 0; background-color: #f4f4f4;
            display: flex; justify-content: center; align-items: center;
            height: 100vh; font-family: 'Segoe UI', Tahoma, sans-serif;
        }
        #map-container {
            width: 800px; height: 600px; position: relative;
            border: 2px solid #ccc; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2);
            background: white; overflow: hidden;
        }
        #map { width: 100%; height: 100%; }
        .info-panel {
            position: absolute; top: 15px; left: 15px; z-index: 1001;
            background: rgba(255, 255, 255, 0.95); padding: 15px;
            border-radius: 4px; border-left: 5px solid #007bff;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1); width: 300px;
        }
        .info-panel h2 { margin: 0 0 5px 0; font-size: 14px; color: #333; text-transform: uppercase; }
        .info-panel p { margin: 3px 0; font-size: 11px; color: #555; }
        .coords-list {
            background: #f8f9fa; padding: 8px; border: 1px solid #ddd;
            margin-top: 10px; max-height: 150px; overflow-y: auto;
            font-family: monospace; font-size: 10px;
        }
        .btn-export {
            margin-top: 10px; width: 100%; padding: 8px;
            background: #007bff; color: white; border: none;
            border-radius: 3px; cursor: pointer; font-size: 11px; font-weight: bold;
        }
    </style>
</head>

<body>

    <div id="map-container">
        <div class="info-panel">
            <h2>SC_ Quadra Ajustada</h2>
            <p><strong>Município:</strong> Capanema - PR</p>
            <p><strong>Status:</strong> Coordenadas Fixas Inseridas</p>
            <div id="vertex-display" class="coords-list"></div>
            <button class="btn-export" onclick="exportarJSON()">EXPORTAR JSON ATUALIZADO</button>
        </div>
        <div id="map"></div>
    </div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Coordenadas fornecidas
        const verticesFinais = [
            { "id": "V1", "lat": -25.6801397, "lng": -53.8021866 },
            { "id": "V2", "lat": -25.6803797, "lng": -53.801226 },
            { "id": "V3", "lat": -25.6813319, "lng": -53.801519 },
            { "id": "V4", "lat": -25.6810919, "lng": -53.8024796 }
        ];

        // Centroide aproximado para visualização
        const centroMapa = [-25.6807358, -53.8018528];

        const map = L.map('map', {
            zoomControl: false,
            attributionControl: false
        }).setView(centroMapa, 19);

        L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png').addTo(map);

        function renderizarQuadra() {
            let html = "";
            const latLngs = verticesFinais.map(v => {
                html += `<b>${v.id}:</b> ${v.lat}, ${v.lng}<br>`;
                return [v.lat, v.lng];
            });

            document.getElementById('vertex-display').innerHTML = html;

            // Desenhar Polígono Azul (Padrão de ajuste confirmado)
            L.polygon(latLngs, {
                color: '#007bff',
                fillColor: '#007bff',
                fillOpacity: 0.2,
                weight: 3
            }).addTo(map);

            // Adicionar Marcadores nos Vértices
            verticesFinais.forEach(v => {
                L.circleMarker([v.lat, v.lng], {
                    radius: 4,
                    color: '#007bff',
                    fillOpacity: 1
                }).addTo(map).bindTooltip(v.id, { permanent: true, direction: 'top' });
            });
        }

        function exportarJSON() {
            const dataStr = "data:text/json;charset=utf-8," + encodeURIComponent(JSON.stringify(verticesFinais, null, 2));
            const dlAnchor = document.createElement('a');
            dlAnchor.setAttribute("href", dataStr);
            dlAnchor.setAttribute("download", "sc_quadra_coordenadas_fixas.json");
            dlAnchor.click();
        }

        renderizarQuadra();
        setTimeout(() => map.invalidateSize(), 200);
    </script>
</body>

</html>
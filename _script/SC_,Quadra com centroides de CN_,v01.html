<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Visualizador Fixo - SuperCIATA</title>
    
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    
    <style>
        /* Centraliza o mapa na tela do navegador para facilitar o print */
        body { 
            margin: 0; 
            padding: 0; 
            background-color: #f4f4f4; 
            display: flex; 
            justify-content: center; 
            align-items: center; 
            height: 100vh;
            font-family: 'Segoe UI', Tahoma, sans-serif; 
        }

        /* Define a Janela com Tamanho Fixo */
        #map-container {
            width: 800px;
            height: 600px;
            position: relative;
            border: 2px solid #ccc;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            background: white;
            overflow: hidden;
        }

        #map { 
            width: 100%; 
            height: 100%; 
        }
        
        .info-panel {
            position: absolute; top: 10px; left: 10px; z-index: 1000;
            background: rgba(255, 255, 255, 0.95);
            padding: 12px; border-radius: 4px;
            border-left: 4px solid #ff7800;
            line-height: 1.3;
            pointer-events: none; /* Não interfere no mapa */
        }

        .info-panel h2 { margin: 0 0 5px 0; font-size: 14px; color: #333; text-transform: uppercase; }
        .info-panel p { margin: 2px 0; font-size: 12px; color: #555; }
        .note { margin-top: 8px; font-size: 10px; color: #888; font-style: italic; max-width: 200px; }

        .label-face {
            background: rgba(0, 0, 0, 0.7);
            color: #fff; border: none; padding: 2px 4px;
            border-radius: 3px; font-size: 10px; font-weight: bold;
        }
    </style>
</head>
<body>

<div id="map-container">
    <div class="info-panel">
        <h2>Quadra SuperCIATA sem ajuste OSM</h2>
        <p><strong>Quadra:</strong> 01.03.002.3.0054</p>
        <p><strong>Município:</strong> 4104501 - Capanema - PR</p>
        <p><strong>Área Estimada:</strong> 11.000 m²</p>
        <div class="note">Base horizontal: Face 0 (Norte).</div>
    </div>
    <div id="map"></div>
</div>

<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script>
    const dadosQuadra = {
        "CI_ID_QUADRA": "01.03.002.3.0054",
        "COD_MUNICIPIO": "4104501",
        "FACES": [
            { "SC_ID_LOGRADOURO": "9003F37C", "CI_NOM_LOGRADOURO": "AV. PARANA", "DIM_FACE": 100, "ORDEM_FACE": 0, "CENTROIDE": [-25.68023275, -53.80173725] },
            { "SC_ID_LOGRADOURO": "F0D334EC", "CI_NOM_LOGRADOURO": "RUA CARAMURUS", "DIM_FACE": 110, "ORDEM_FACE": 1, "CENTROIDE": [-25.680921, -53.80135666] },
            { "SC_ID_LOGRADOURO": "F54DE0AF", "CI_NOM_LOGRADOURO": "RUA SANTA CATARINA", "DIM_FACE": 100, "ORDEM_FACE": 2, "CENTROIDE": [-25.68122037, -53.80201275] },
            { "SC_ID_LOGRADOURO": "1558A9D1", "CI_NOM_LOGRADOURO": "AV. UBIRAJARAS", "DIM_FACE": 110, "ORDEM_FACE": 3, "CENTROIDE": [-25.6805995, -53.8023365] }
        ]
    };

    // Centro e Opções de Travamento
    const centroMapa = [-25.68070, -53.80205];
    const map = L.map('map', { 
        maxZoom: 19,
        minZoom: 19,
        zoomControl: false,
        dragging: false,      // Desativa arrastar
        scrollWheelZoom: false, // Desativa zoom no mouse
        doubleClickZoom: false, // Desativa zoom no clique duplo
        touchZoom: false      // Desativa zoom no touch
    }).setView(centroMapa, 19);

    L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
        maxZoom: 19,
        attribution: '&copy; OSM'
    }).addTo(map);

    function calcularVertices(dados) {
        const f0 = dados.FACES[0];
        const f1 = dados.FACES[1];
        const mLat = 111320; 
        const mLon = 111320 * Math.cos(f0.CENTROIDE[0] * Math.PI / 180);
        const dLat = (f1.DIM_FACE / mLat);
        const dLon = (f0.DIM_FACE / mLon);

        return [
            [f0.CENTROIDE[0], f0.CENTROIDE[1] - (dLon / 2)],
            [f0.CENTROIDE[0], f0.CENTROIDE[1] + (dLon / 2)],
            [f0.CENTROIDE[0] - dLat, f0.CENTROIDE[1] + (dLon / 2)],
            [f0.CENTROIDE[0] - dLat, f0.CENTROIDE[1] - (dLon / 2)]
        ];
    }

    L.polygon(calcularVertices(dadosQuadra), {
        color: '#ff7800', fillColor: '#ff7800', fillOpacity: 0.15, weight: 3
    }).addTo(map);

    dadosQuadra.FACES.forEach(face => {
        L.circleMarker(face.CENTROIDE, {
            radius: 5, fillColor: "#ff7800", color: "#fff", weight: 2, fillOpacity: 1
        }).addTo(map);

        L.marker(face.CENTROIDE, { icon: L.divIcon({ className: 'dummy' }) })
            .addTo(map)
            .bindTooltip(`${face.CI_NOM_LOGRADOURO}<br>${face.DIM_FACE}m`, {
                permanent: true, direction: 'top', offset: [0, -10], className: 'label-face'
            });
    });
</script>
</body>
</html>